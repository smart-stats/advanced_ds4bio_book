<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.245">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Advanced Data Science for Public Health - 17&nbsp; Causal DAGs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./graphics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Causal DAGs</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Data Science for Public Health</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/smart-stats/advanced_ds4bio_book" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interactive.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Interactive graphics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./webscraping.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Advanced web scrapping</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./images.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with images</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./databases.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Databases</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pipelines.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Pipelines</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_structures.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data structures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diymlai.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">DIY ML/AI</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./convnet_example.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Example convnet</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unsupervised.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Unsupervised learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variationalAEs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Variational autoencoders</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nlp.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">NLP</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_analysis_theory.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data science, conceptually</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat_language.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Statistics and language</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_science_as_a_science.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Data science as an applied science</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Theory of graphical display</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causal.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Causal DAGs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#associational-models-versus-causal-models" id="toc-associational-models-versus-causal-models" class="nav-link active" data-scroll-target="#associational-models-versus-causal-models"><span class="toc-section-number">17.1</span>  Associational models versus causal models</a>
  <ul class="collapse">
  <li><a href="#structural-causal-models" id="toc-structural-causal-models" class="nav-link" data-scroll-target="#structural-causal-models"><span class="toc-section-number">17.1.1</span>  Structural causal models</a></li>
  <li><a href="#blocking-and-d-separation" id="toc-blocking-and-d-separation" class="nav-link" data-scroll-target="#blocking-and-d-separation"><span class="toc-section-number">17.1.2</span>  Blocking and d-separation</a></li>
  </ul></li>
  <li><a href="#do-calculus-and-backdoor-criterion" id="toc-do-calculus-and-backdoor-criterion" class="nav-link" data-scroll-target="#do-calculus-and-backdoor-criterion"><span class="toc-section-number">17.2</span>  Do calculus and backdoor criterion</a></li>
  <li><a href="#reading" id="toc-reading" class="nav-link" data-scroll-target="#reading"><span class="toc-section-number">17.3</span>  Reading:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Causal DAGs</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="associational-models-versus-causal-models" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="associational-models-versus-causal-models"><span class="header-section-number">17.1</span> Associational models versus causal models</h2>
<p>Causal models differ from associational models in that they codify causal directions not just associations. In our program, you might have learned of the use of propensity scores, counterfactuals or randomization to study causality. There, typically the goal is to make causal statements with as few assumptions as possible or at least understanding the assumptions. Typically the object of study is the estimation of an effect avergated over covarites.</p>
<p>Causal graphs take a different approach, even if they wind up at a similar same place. Here, the goal is to postulate hyptothetical causal relationships and use those hypothetical relationships to estimate causal effects. In that sense, they use more assumptions. But, on the other hand, the very act of postulating causal relationships has a benefit unto itself. Moreover, causal graphs intersect with understanding causal theory more generally.</p>
<section id="structural-causal-models" class="level3" data-number="17.1.1">
<h3 data-number="17.1.1" class="anchored" data-anchor-id="structural-causal-models"><span class="header-section-number">17.1.1</span> Structural causal models</h3>
<p>A structural causal model (SCM) over a collection of variables, <span class="math inline">\(X=(X_1, \ldots, X_p)\)</span>, postulates a set of functional relationships <span class="math display">\[
X_j = f(P_j, \epsilon_j)
\]</span> where <span class="math inline">\(P_j\)</span> are the antecedent causes of <span class="math inline">\(X_j\)</span>, called the parents of <span class="math inline">\(X_j\)</span>, and <span class="math inline">\(\epsilon_j\)</span> is an accumulation of variables treated as mutally independent. This defines a directed graph, <span class="math inline">\(G\)</span> say, where a graph is collection of vertices corresponding to our variables, <span class="math inline">\(V=\{1,\ldots, p\}\)</span>, corresponding to the <span class="math inline">\(X_i\)</span>, and edges, <span class="math inline">\(E\)</span>, which is a set of ordered pairs of nodes. Node <span class="math inline">\(i\)</span> is a parent of node <span class="math inline">\(j\)</span> if <span class="math inline">\((i,j) \in E\)</span> and <span class="math inline">\((j,i)\notin E\)</span>. Similarly, node <span class="math inline">\(i\)</span> is a <strong>child</strong> of node <span class="math inline">\(j\)</span> if <span class="math inline">\((j,i) \in E\)</span> and <span class="math inline">\((i,j)\notin E\)</span>. A node is a <strong>descendant</strong> of another if it is a child, or a child of a child and so on.</p>
<div class="cell" data-fig-width="3">
<div class="cell-output-display">
<div id="three-node">
<p>
<svg width="288" height="480" viewbox="0.00 0.00 134.00 116.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-112 130,-112 130,4 -4,4"></polygon> <!-- X1 --> <g id="node1" class="node">
<title>
X1
</title>
<ellipse fill="none" stroke="black" cx="63" cy="-90" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="63" y="-85.8" font-family="Times,serif" font-size="14.00">X1</text> </g> <!-- X2 --> <g id="node2" class="node">
<title>
X2
</title>
<ellipse fill="none" stroke="black" cx="27" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="27" y="-13.8" font-family="Times,serif" font-size="14.00">X2</text> </g> <!-- X1&#45;&gt;X2 --> <g id="edge1" class="edge">
<title>
X1-&gt;X2
</title>
<path fill="none" stroke="black" d="M54.65,-72.76C50.29,-64.28 44.85,-53.71 39.96,-44.2"></path> <polygon fill="black" stroke="black" points="42.99,-42.44 35.3,-35.15 36.77,-45.64 42.99,-42.44"></polygon> </g> <!-- X3 --> <g id="node3" class="node">
<title>
X3
</title>
<ellipse fill="none" stroke="black" cx="99" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="99" y="-13.8" font-family="Times,serif" font-size="14.00">X3</text> </g> <!-- X1&#45;&gt;X3 --> <g id="edge2" class="edge">
<title>
X1-&gt;X3
</title>
<path fill="none" stroke="black" d="M71.35,-72.76C75.71,-64.28 81.15,-53.71 86.04,-44.2"></path> <polygon fill="black" stroke="black" points="89.23,-45.64 90.7,-35.15 83.01,-42.44 89.23,-45.64"></polygon> </g> <!-- X2&#45;&gt;X3 --> <g id="edge3" class="edge">
<title>
X2-&gt;X3
</title>
<path fill="none" stroke="black" d="M54,-18C56.61,-18 59.23,-18 61.84,-18"></path> <polygon fill="black" stroke="black" points="61.93,-21.5 71.93,-18 61.93,-14.5 61.93,-21.5"></polygon> </g> </g>
</svg>
</p>
<p>A simple causal diagram.</p>
</div>
</div>
</div>
<p>In this case, <span class="math inline">\(P_1 = \{\}\)</span>, <span class="math inline">\(P_2 = \{1\}\)</span> and <span class="math inline">\(P_3 = \{1,2\}\)</span>. SCMs define a unique probability distribution over <span class="math inline">\(X\)</span>.</p>
<p>Given a cross-sectional sample, we can estimate the joint distribution of <span class="math inline">\(P(X_1,\ldots, X_p)\)</span> and all of its conditionals. These conditionals must agree with the causal graph in a sense. Specifically, it agrees with the conditional independence (Markov) model implied by the associated <em>undirected</em> graph. Causality comes in from our assuming arrows and using these assumptions in a specific way.</p>
<p>One specific way in which we use the assumptions is to investigate how the graph changes when we fix a node at a specific value, like an intevention, thus breaking its association with its parents. This operation is conceptual, but at times we can relate probabilities associated with interventions that were not realized. Consider an instrance where where <span class="math inline">\(X_1\)</span> is a collection of confounders, <span class="math inline">\(X_2\)</span> is an exposure and <span class="math inline">\(X_3\)</span> is an outcome. Ideally, we’d like to know <span class="math display">\[
P(X_3 ~|~ do(X_2) = x_2)
\]</span> That is, the impact on the response if we were to set the exposure to <span class="math inline">\(e_0\)</span>.</p>
</section>
<section id="blocking-and-d-separation" class="level3" data-number="17.1.2">
<h3 data-number="17.1.2" class="anchored" data-anchor-id="blocking-and-d-separation"><span class="header-section-number">17.1.2</span> Blocking and d-separation</h3>
<p>Return to diagram <span class="citation" data-cites="three-node">(<a href="references.html#ref-three-node" role="doc-biblioref"><strong>three-node?</strong></a>)</span>.</p>
<ul>
<li><span class="math inline">\(X1\)</span> is a <em>confounder</em> betweend <span class="math inline">\(X2\)</span> and <span class="math inline">\(X3\)</span></li>
<li><span class="math inline">\(X2\)</span> is a <em>mediator</em> between <span class="math inline">\(X1\)</span> and <span class="math inline">\(X3\)</span></li>
<li><span class="math inline">\(X3\)</span> is a <em>collider</em> between <span class="math inline">\(X1\)</span> and <span class="math inline">\(X2\)</span></li>
</ul>
<p>Consider an example. <span class="math inline">\(X1\)</span> is having a BMI &gt; 35, <span class="math inline">\(X2\)</span> is sleep disordered breathing and <span class="math inline">\(X3\)</span> is hypertension.</p>
<div class="cell" data-fig-width="3">
<div class="cell-output-display">
<div>
<p>
<svg width="288" height="480" viewbox="0.00 0.00 147.71 116.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-112 143.71,-112 143.71,4 -4,4"></polygon> <!-- BMI35 --> <g id="node1" class="node">
<title>
BMI35
</title>
<ellipse fill="none" stroke="black" cx="68.82" cy="-90" rx="38.87" ry="18"></ellipse> <text text-anchor="middle" x="68.82" y="-85.8" font-family="Times,serif" font-size="14.00">BMI35</text> </g> <!-- SDB --> <g id="node2" class="node">
<title>
SDB
</title>
<ellipse fill="none" stroke="black" cx="29.82" cy="-18" rx="29.65" ry="18"></ellipse> <text text-anchor="middle" x="29.82" y="-13.8" font-family="Times,serif" font-size="14.00">SDB</text> </g> <!-- BMI35&#45;&gt;SDB --> <g id="edge1" class="edge">
<title>
BMI35-&gt;SDB
</title>
<path fill="none" stroke="black" d="M59.58,-72.41C54.92,-64.04 49.16,-53.71 43.96,-44.37"></path> <polygon fill="black" stroke="black" points="46.92,-42.5 39,-35.47 40.81,-45.91 46.92,-42.5"></polygon> </g> <!-- HTN --> <g id="node3" class="node">
<title>
HTN
</title>
<ellipse fill="none" stroke="black" cx="108.82" cy="-18" rx="30.77" ry="18"></ellipse> <text text-anchor="middle" x="108.82" y="-13.8" font-family="Times,serif" font-size="14.00">HTN</text> </g> <!-- BMI35&#45;&gt;HTN --> <g id="edge2" class="edge">
<title>
BMI35-&gt;HTN
</title>
<path fill="none" stroke="black" d="M78.3,-72.41C83.08,-64.04 88.99,-53.71 94.33,-44.37"></path> <polygon fill="black" stroke="black" points="97.49,-45.89 99.41,-35.47 91.41,-42.42 97.49,-45.89"></polygon> </g> <!-- SDB&#45;&gt;HTN --> <g id="edge3" class="edge">
<title>
SDB-&gt;HTN
</title>
<path fill="none" stroke="black" d="M59.76,-18C62.38,-18 65.01,-18 67.64,-18"></path> <polygon fill="black" stroke="black" points="67.77,-21.5 77.77,-18 67.77,-14.5 67.77,-21.5"></polygon> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<p>Here if we’re studying whether SDB causes HTN, BMI35 confounds the relationship as a possible common cause of both. We would need to adjust for BMI35 to make sure the association between SDB and HTN isn’t just due to this common cause.</p>
<p>If we were studying whether BMI35 causes HTN, we might be interested in how much of that effect is mediated (indirectly) through SDB and how much is directly from BMI35.</p>
<p>If we are studying the relationship between BMI35 and SDB directly, adjusting for HTN may cause an association. Consider the (fictitious) case where there is a large number of people who have SDB who are not obese, yet all have hypertension, for whatever the reason. Then, among the HTN, there could be a negative association between BMI35 and SDB, because of the large collection of patients would who have SDB and are not obese and the same for obese and not hyptertensive. That is, adjusting for HTN created an association. This is an example of <a href="https://en.wikipedia.org/wiki/Berkson%27s_paradox">Berkson’s paradox</a>. This is a somewhat contrived example, but hopefully you get the point. The wikipedia article has a funny example where they consider <span class="math inline">\(X_1\)</span> is whether or not the hamburger is good at a fast food restaurant, <span class="math inline">\(X_2\)</span> is whether or not the fries are good and <span class="math inline">\(X_3\)</span> is whether or not people eat there. Since few people would eat at a place where both the hamburger and fries are bad, conditioning on <span class="math inline">\(X_3\)</span> can create a negative association.</p>
<p>The main point here is that adjusting for colliders may open up a pathway between the nodes.</p>
<p>A <strong>path</strong> between two nodes <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_k\)</span> is a sequence of nodes, <span class="math inline">\(v_1, v_2,\ldots v_{k}\)</span>, where <span class="math inline">\(v_{i}\)</span> and <span class="math inline">\(v_{i+1}\)</span> are connected. The path is <strong>directed</strong> if <span class="math inline">\(v_{i}\)</span> points to <span class="math inline">\(v_{i+1}\)</span> for <span class="math inline">\(i=1,\ldots,k\)</span>. A graph is a Directed Acyclic Graph (DAG) if all edges are directed and there are no two nodes <span class="math inline">\(v_i\)</span> and <span class="math inline">\(v_j\)</span> with a directed path in both directions.</p>
<p>A path between <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_k\)</span>, <span class="math inline">\(v_1,\ldots, v_k\)</span>, is blocked by a set of nodes, <span class="math inline">\(S\)</span>, if for some <span class="math inline">\(v_j\)</span> in <span class="math inline">\(S\)</span></p>
<ol type="1">
<li><span class="math inline">\(v_j\in S\)</span> and <span class="math inline">\(v_k\)</span> is a mediator or confounder between <span class="math inline">\(v_{j-1}\)</span> and <span class="math inline">\(v_{j+1}\)</span> in either direction <strong>or</strong></li>
<li><span class="math inline">\(v_j\notin S\)</span> and all of the descendants of <span class="math inline">\(v_j \notin S\)</span> and <span class="math inline">\(v_{j}\)</span> is a collider between <span class="math inline">\(v_{j-1}\)</span> and <span class="math inline">\(v_{j+1}\)</span>.</li>
</ol>
<p>In other words, a path is blocked if a mediator or confounder is included in <span class="math inline">\(S\)</span> or a collider and all of its descendants is excluded from <span class="math inline">\(S\)</span>.</p>
<p>For 1. this is equivalent to saying one of</p>
<ul>
<li><span class="math inline">\(v_{j-1}\rightarrow v_{j} \rightarrow v_{j+1}\)</span></li>
<li><span class="math inline">\(v_{j-1}\leftarrow v_{j} \leftarrow v_{j+1}\)</span></li>
<li><span class="math inline">\(v_{j-1}\leftarrow v_{j} \rightarrow v_{j+1}\)</span></li>
</ul>
<p>holds. For 2. recall a collider is <span class="math inline">\(v_{j-1}\rightarrow v_{j} \leftarrow v_{j+1}\)</span>.</p>
<p>We say that two nodes or groups of nodes are <strong>D-Separated</strong> by a set of nodes, <span class="math inline">\(S\)</span>, if every path between nodes in the two groups is blocked by <span class="math inline">\(S\)</span>.</p>
<p>Consider the following graph.</p>
<div class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<p><img src="causal_files/figure-html/cell-3-output-1.png" width="691" height="499"></p>
</div>
</div>
<p>Here are the minimal valid D-separating paths between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>:</p>
<ol type="1">
<li><span class="math inline">\(S = \{X_2, X_3\}\)</span></li>
<li><span class="math inline">\(S = \{X_3, X_5\}\)</span></li>
<li><span class="math inline">\(S = \{X_4, X_5\}\)</span></li>
</ol>
<p>Here are some <strong>invalid</strong> D-separating sets.</p>
<ol type="1">
<li><span class="math inline">\(S\)</span> equal to any single node. Example, <span class="math inline">\(S=\{X_3\}\)</span>. This does not block the path <span class="math inline">\(X\leftarrow X_2 \rightarrow X_3 \leftarrow X_5 \rightarrow Y\)</span>.</li>
<li><span class="math inline">\(S=\{X_3, X_4\}\)</span> does not block the path <span class="math inline">\(X \leftarrow X_2 \rightarrow X_3 \leftarrow X_5 \rightarrow Y\)</span>.</li>
<li><span class="math inline">\(S=\{X_2, X_4\}\)</span>. does not block the path <span class="math inline">\(X\leftarrow X_3 \leftarrow X_5 \rightarrow Y\)</span>.</li>
</ol>
<p>Importantly, if <span class="math inline">\(S\)</span> D-separates <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> then in the implied distribution from the SCM, <span class="math inline">\(X \perp Y ~|~ S\)</span>.</p>
</section>
</section>
<section id="do-calculus-and-backdoor-criterion" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="do-calculus-and-backdoor-criterion"><span class="header-section-number">17.2</span> Do calculus and backdoor criterion</h2>
<p>Recall that specifying a causal graph model implies a probability distribution. Moreover, the implied independence relationships are given by the undirected graph.</p>
<p>Consider a theoretical intervention obtained by setting <span class="math inline">\(X = a\)</span>, which we write as <span class="math inline">\(do(X) = a\)</span>. We want to estimate <span class="math inline">\(P(Y ~|~ do(X) = a)\)</span>, which is fundamentally different than <span class="math inline">\(P(Y ~|~ X = a)\)</span>.</p>
<p>A set <span class="math inline">\(Z\)</span> satisfies the <strong>back door</strong> criterion with respect to nodes <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> if</p>
<ol type="1">
<li>No descendant of <span class="math inline">\(X\)</span> is in <span class="math inline">\(Z\)</span>.</li>
<li><span class="math inline">\(Z\)</span> blocks every path <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> that contains an arrow pointing to <span class="math inline">\(Y\)</span>.</li>
</ol>
<p>The magic of the back door adjustment comes from the relationship:</p>
<p><span class="math display">\[
P(Y ~|~ do(X) = x) = \sum_{z} P(y ~ | x, z) p(z)
\]</span></p>
<p>where <span class="math inline">\(z\)</span> are the collection of variables in <span class="math inline">\(S\)</span>. If the <span class="math inline">\(z\)</span> are all observed variables, then the RHS of this equation is estimable. Note the interesting statement that not all variables need to be observed, just <span class="math inline">\(y\)</span>, <span class="math inline">\(x\)</span> and <span class="math inline">\(z\)</span>.</p>
</section>
<section id="reading" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="reading"><span class="header-section-number">17.3</span> Reading:</h2>
<ul>
<li>I got most of this stuff from <span class="citation" data-cites="peters2017elements">Peters, Janzing, and Schölkopf (<a href="references.html#ref-peters2017elements" role="doc-biblioref">2017</a>)</span>, which you can read <a href="https://library.oapen.org/bitstream/id/056a11be-ce3a-44b9-8987-a6c68fce8d9b/11283.pdf">here</a></li>
<li>Also read <span class="citation" data-cites="hardt2021patterns">Hardt and Recht (<a href="references.html#ref-hardt2021patterns" role="doc-biblioref">2021</a>)</span>, which you can read <a href="https://mlstory.org/index.html">here</a></li>
<li><a href="https://ftp.cs.ucla.edu/pub/stat_ser/r493.pdf">A crash course in good and bad controls</a>, or <a href="http://causality.cs.ucla.edu/blog/index.php/category/back-door-criterion/">here</a></li>
<li><a href="http://dagitty.net/.html#">dagitty</a></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-hardt2021patterns" class="csl-entry" role="doc-biblioentry">
Hardt, Moritz, and Benjamin Recht. 2021. <span>“Patterns, Predictions, and Actions: A Story about Machine Learning.”</span> <em>arXiv Preprint arXiv:2102.05242</em>.
</div>
<div id="ref-peters2017elements" class="csl-entry" role="doc-biblioentry">
Peters, Jonas, Dominik Janzing, and Bernhard Schölkopf. 2017. <em>Elements of Causal Inference: Foundations and Learning Algorithms</em>. The MIT Press.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./graphics.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Theory of graphical display</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>